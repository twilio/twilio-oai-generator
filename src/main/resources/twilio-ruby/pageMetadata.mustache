                class {{apiName}}PageMetadata < PageMetadata
                    attr_reader :{{#lambda.snakecase}}{{apiName}}{{/lambda.snakecase}}_page

                    def initialize(version, response, solution, limit)
                        super(version, response)
                        @{{#lambda.snakecase}}{{apiName}}{{/lambda.snakecase}}_page = []
                        @limit = limit
                        key = get_key(response.body)
                        number_of_records = response.body[key].size
                        while( limit != :unset && number_of_records <= limit )
                            @{{#lambda.snakecase}}{{apiName}}{{/lambda.snakecase}}_page << {{apiName}}ListResponse.new(version, @payload, key)
                            @payload = self.next_page
                            break unless @payload
                            number_of_records += @payload.body[key].size
                        end
                        # Path Solution
                        @solution = solution
                    end

                    def each
                        @{{#lambda.snakecase}}{{apiName}}{{/lambda.snakecase}}_page.each do |record|
                          yield record
                        end
                    end

                    def to_s
                      '<Twilio::REST::{{domainName}}::{{apiVersionClass}}PageMetadata>';
                    end
                end
                class {{apiName}}ListResponse < InstanceListResource

                    # @param [Array<{{apiName}}Instance>] instance
                    # @param [Hash{String => Object}] headers
                    # @param [Integer] status_code
                    def initialize(version, payload, key)
                      @{{#lambda.snakecase}}{{apiName}}{{/lambda.snakecase}} = payload.body[key].map do |data|
                      {{apiName}}Instance.new(version, data)
                      end
                      @headers = payload.headers
                      @status_code = payload.status_code
                    end

                    def {{#lambda.snakecase}}{{apiName}}{{/lambda.snakecase}}
                        @{{#lambda.snakecase}}{{apiName}}{{/lambda.snakecase}}
                    end
                end
